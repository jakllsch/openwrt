--- a/src/openvpn/socket.h	2019-02-20 06:28:23.000000000 -0600
+++ b/src/openvpn/socket.h	2019-07-08 09:44:46.642606009 -0500
@@ -1212,6 +1212,20 @@
 }
 
 /*
+ * Extract TOS bits.  Assumes that ipbuf is a valid IPv6 packet.
+ */
+static inline void
+link_socket_extract_tos6(struct link_socket *ls, const struct buffer *ipbuf)
+{
+    if (ls && ipbuf)
+    {
+        uint32_t tc = *(uint32_t *) BPTR(ipbuf);
+        ls->ptos = (ntohl(tc) >> 20) & 0xff;
+        ls->ptos_defined = true;
+    }
+}
+
+/*
  * Set socket properties to reflect TOS bits which were extracted
  * from tunnel packet.
  */
